<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Daily Planner</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f7f9fc; margin: 0; padding: 20px; }
    h1 { text-align: center; }
    .planner { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);}
    .task { display: flex; align-items: center; margin: 8px 0; }
    .task input[type="checkbox"] { margin-right: 10px; }
    .task input[disabled] { cursor: not-allowed; }
    #new-task { width: 70%; padding: 8px; }
    button { padding: 8px 12px; margin-left: 8px; border: none; border-radius: 8px; cursor: pointer; background: #007bff; color: white; }
    button:hover { background: #0056b3; }
    .date-title { font-weight: bold; margin-top: 20px; }
    .locked { color: gray; }
    .quote { margin-top: 15px; font-style: italic; text-align: center; color: #444; }
  </style>
</head>
<body>
  <div class="planner">
    <h1>📅 Daily Planner</h1>
    <p class="quote" id="quote"></p>
    <div id="task-container"></div>
    <input type="text" id="new-task" placeholder="Add new task...">
    <button onclick="addTask()">Add Task</button>
    <button onclick="shareProgress()">Share Progress</button>
  </div>

  <script>
    const quotes = [
      "Push yourself, because no one else is going to do it for you.",
      "Success is the sum of small efforts repeated day in and day out.",
      "Your limitation—it’s only your imagination.",
      "Great things never come from comfort zones.",
      "Dream it. Wish it. Do it."
    ];

    document.getElementById("quote").innerText = 
      quotes[new Date().getDate() % quotes.length];

    const taskContainer = document.getElementById("task-container");
    const today = new Date().toISOString().split("T")[0]; // YYYY-MM-DD
    let allTasks = JSON.parse(localStorage.getItem("dailyTasks")) || {};

    // --- rollover logic ---
    if (!allTasks[today]) {
      const yesterday = new Date(Date.now() - 86400000).toISOString().split("T")[0];
      let carryOver = [];
      if (allTasks[yesterday]) {
        carryOver = allTasks[yesterday].filter(t => !t.done); // only incomplete
      }
      allTasks[today] = carryOver;
      localStorage.setItem("dailyTasks", JSON.stringify(allTasks));
    }

    function renderTasks() {
      taskContainer.innerHTML = "";
      for (let date in allTasks) {
        const isToday = date === today;
        const dateTitle = document.createElement("div");
        dateTitle.className = "date-title";
        dateTitle.innerText = isToday ? `Today (${date})` : date;
        taskContainer.appendChild(dateTitle);

        allTasks[date].forEach((task, index) => {
          const taskDiv = document.createElement("div");
          taskDiv.className = "task";

          const checkbox = document.createElement("input");
          checkbox.type = "checkbox";
          checkbox.checked = task.done;
          checkbox.disabled = !isToday; // only today editable
          checkbox.onchange = () => {
            if (checkbox.checked) {
              allTasks[date][index].done = true;
              localStorage.setItem("dailyTasks", JSON.stringify(allTasks));
            }
            checkbox.disabled = true; // lock once checked
          };

          const label = document.createElement("span");
          label.innerText = task.text;
          if (!isToday) label.className = "locked";

          taskDiv.appendChild(checkbox);
          taskDiv.appendChild(label);
          taskContainer.appendChild(taskDiv);
        });
      }
    }

    function addTask() {
      const input = document.getElementById("new-task");
      const text = input.value.trim();
      if (!text) return;
      allTasks[today].push({ text, done: false });
      input.value = "";
      localStorage.setItem("dailyTasks", JSON.stringify(allTasks));
      renderTasks();
    }

    function shareProgress() {
      const todayTasks = allTasks[today] || [];
      let msg = `📅 Progress for ${today}\n\n`;
      todayTasks.forEach(t => {
        msg += `${t.done ? "✅" : "❌"} ${t.text}\n`;
      });
      navigator.clipboard.writeText(msg).then(() => {
        alert("Progress copied! Paste it in chat to share.");
      });
    }

    renderTasks();
  </script>
</body>
</html>
